<script id="script_test_template_path__test_uuid" type="text/javascript">
    document.addEventListener("DOMContentLoaded", function(event) {

    // Common code
    if(typeof(WS_INCLUDE_WEBSOCKET) === "undefined"){
        WS_INCLUDE_WEBSOCKET = new WebSocket("ws://" + window.location.host + "/ws/ws_include/");

        // When a message is received, replace block content with the HTML
        WS_INCLUDE_WEBSOCKET.addEventListener("message", event => {
            const wsJsonResponse = JSON.parse(event.data);
            const blockId = wsJsonResponse["blockId"];
            const scriptBlockId = `script_${blockId}`;
            document.getElementById(scriptBlockId).remove();
            document.getElementById(blockId).innerHTML = wsJsonResponse["html"];
        });
    }

    // Send a message for each block once the websocket is open
    WS_INCLUDE_WEBSOCKET.addEventListener("open", event => {
        const blockId = "test_template_path__test_uuid";
        const context = {};
        const wsRequest = JSON.stringify({
            block_id: blockId,
            path: "ws_include/spinner.html",
            language_code: "en-us",
            context: context
        });
        // Delete previous content unless it is the spinner
        try{
            document.querySelector("#test_template_path__test_uuid > :not(.ws_included-spinner)").remove();
        }catch(TypeError){
        }

        WS_INCLUDE_WEBSOCKET.send(wsRequest);
    });
});

</script>

<div id="test_template_path__test_uuid" class="ws_included-block test_template_path" data-request-function="ws__test_template_path__test_uuid">
    <span id="spinner_test_template_path__test_uuid" class="fa fa-spinner fa-spin fa-2x ws_included-spinner"></span>
</div>